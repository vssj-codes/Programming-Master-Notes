### Python Django Tutorial: Full-Featured Web App Part 5 - Database and Migrations

#### Key Insights

- **Introduction to ORM**:
  - ORM stands for Object-Relational Mapper.
  - Allows interaction with the database using an object-oriented approach.
  - Supports multiple databases (e.g., SQLite for development and Postgres for production).

- **Creating Models**:
  - Models represent database tables as classes.
  - Example: Creating a `Post` model in `models.py`.

- **Defining Model Fields**:
  - Fields represent columns in the database table.
  - Example fields for `Post` model:
    - `title`: `models.CharField(max_length=100)`
    - `content`: `models.TextField()`
    - `date_posted`: `models.DateTimeField(default=timezone.now)`
    - `author`: `models.ForeignKey(User, on_delete=models.CASCADE)`

- **Migrations**:
  - `python manage.py makemigrations` generates migration files.
  - `python manage.py migrate` applies migrations to the database.
  - Migration files contain SQL code to create/update database schema.

- **Django Shell for Interactive Queries**:
  - `python manage.py shell` to interact with models.
  - Example queries:
    - `User.objects.all()`: Retrieve all users.
    - `User.objects.first()`: Retrieves 1st user.
    - `User.objects.filter(username="jyo")`: Returns a QuerySet.
    - `Post.objects.all()`: Retrieve all posts.
    - `Post.objects.filter(author=user)`: Retrieve posts by a specific user.
    - `Post.objects.filter(author=user).first()`: Retrieves 1st post by specific user

- **Model Relationships**:
  - One-to-many relationship: One user can have multiple posts.
  - Specified using `models.ForeignKey`.

- **String Representation of Models**:
  - Define `__str__` method to provide a readable string representation.
  - Example: `def __str__(self): return self.title`

- **Using Models in Views**:
  - Import models in views: `from .models import Post`.
  - Replace dummy data with actual data from the database.

- **Admin Site Configuration**:
  - Register models to appear in the admin site: `admin.site.register(Post)`.
  - Allows creating, updating, and deleting posts via the admin interface.

#### Code Snippets

- **Post Model Definition**:
  ```python
  from django.db import models
  from django.utils import timezone
  from django.contrib.auth.models import User

  class Post(models.Model):
      title = models.CharField(max_length=100)
      content = models.TextField()
      date_posted = models.DateTimeField(default=timezone.now)
      author = models.ForeignKey(User, on_delete=models.CASCADE)

      def __str__(self):
          return self.title
  ```

- **Running Migrations**:
  ```bash
  python manage.py makemigrations
  python manage.py migrate
  ```

- **Interactive Queries in Django Shell**:
  ```python
  from blog.models import Post
  from django.contrib.auth.models import User

  # Get all users
  User.objects.all()

  # Get all posts
  Post.objects.all()

  # Get posts by a specific user
  user = User.objects.get(username='coreyms')
  posts_by_user = Post.objects.filter(author=user)

  # Create a new post
  new_post = Post(title='New Post', content='Post content', author=user)
  new_post.save()
  ```

- **Using Models in Views**:
  ```python
  from django.shortcuts import render
  from .models import Post

  def home(request):
      context = {
          'posts': Post.objects.all()
      }
      return render(request, 'blog/home.html', context)
  ```

- **Registering Models in Admin Site**:
  ```python
  from django.contrib import admin
  from .models import Post

  admin.site.register(Post)
  ```

- **Date Formatting in Templates**:
  ```html
  
  {{ post.date_posted|date:"F d, Y" }}
  ```