# Python Django Tutorial: How to enable HTTPS with a free SSL/TLS Certificate using Let's Encrypt

## Key Insights:

- **Introduction:**
  - Secure your web server by enabling HTTPS with a free certificate using Let's Encrypt.
  - Custom domain name setup; securing the connection.

- **Let's Encrypt Overview:**
  - Certificate authority providing free SSL/TLS certificates.
  - Allows easy certificate management for your site.

- **Server Access:**
  - SSH access to your server is required.
  - Use Certbot client recommended by Let's Encrypt for certificate installation.

- **Installation Steps:**
  - **Step 1: SSH into Server:**
    - Access your server using SSH.
  - **Step 2: Update Packages and Install Dependencies:**
    ```bash
    sudo apt-get update
    sudo apt-get install software-properties-common
    sudo add-apt-repository universe
    sudo add-apt-repository ppa:certbot/certbot
    sudo apt-get update
    sudo apt-get install python-certbot-apache
    ```
  - **Step 3: Apache Configuration:**
    - Update Apache configuration file:
      ```bash
      sudo nano /etc/apache2/sites-available/your_project.conf
      ```
    - Add server name and comment out WSGI commands temporarily:
      ```apache
      ServerName your_domain.com

      # Comment out these lines temporarily:
      # WSGIScriptAlias / /path/to/your/project/wsgi.py
      # WSGIDaemonProcess your_project python-path=/path/to/your/project python-home=/path/to/your/venv
      # WSGIProcessGroup your_project
      ```

- **Certbot Execution:**
  - **Run Certbot Command:**
    ```bash
    sudo certbot --apache
    ```
  - Follow the prompts to complete the certificate installation:
    - Enter email address.
    - Agree to the Terms of Service.
    - Select the domain to activate HTTPS.
    - Choose to redirect HTTP traffic to HTTPS.

- **Configuration Adjustments:**
  - **Update Configuration Files:**
    - Edit the new SSL configuration file:
      ```bash
      sudo nano /etc/apache2/sites-available/your_project-le-ssl.conf
      ```
    - Uncomment WSGI commands in the new SSL configuration file:
      ```apache
      WSGIScriptAlias / /path/to/your/project/wsgi.py
      WSGIDaemonProcess your_project python-path=/path/to/your/project python-home=/path/to/your/venv
      WSGIProcessGroup your_project
      ```

- **Final Steps:**
  - **Allow HTTPS Traffic:**
    ```bash
    sudo ufw allow 'Apache Full'
    ```
  - **Restart Apache Server:**
    ```bash
    sudo service apache2 restart
    ```
  - **Test Configuration:**
    ```bash
    sudo apache2ctl configtest
    sudo systemctl reload apache2
    ```

- **Automatic Renewal:**
  - **Set Up Cron Job for Renewal:**
    ```bash
    sudo crontab -e
    ```
    - Add the following line to run the renewal command monthly:
      ```cron
      30 4 1 * * sudo certbot renew --quiet
      ```

## Code Snippets:

- **Apache Configuration File:**
  ```apache
  <VirtualHost *:80>
      ServerName your_domain.com
      # Other configurations...

      RewriteEngine on
      RewriteCond %{SERVER_NAME} =your_domain.com
      RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
  </VirtualHost>
  ```

- **SSL Configuration File:**
  ```apache
  <IfModule mod_ssl.c>
      <VirtualHost *:443>
          ServerName your_domain.com
          # Other configurations...

          SSLCertificateFile /etc/letsencrypt/live/your_domain.com/fullchain.pem
          SSLCertificateKeyFile /etc/letsencrypt/live/your_domain.com/privkey.pem
          Include /etc/letsencrypt/options-ssl-apache.conf

          WSGIScriptAlias / /path/to/your/project/wsgi.py
          WSGIDaemonProcess your_project python-path=/path/to/your/project python-home=/path/to/your/venv
          WSGIProcessGroup your_project
      </VirtualHost>
  </IfModule>
  ```

- **Cron Job for Automatic Renewal:**
  ```cron
  30 4 1 * * sudo certbot renew --quiet
  ```

By following these steps and using the provided code snippets, you can enable HTTPS on your Django web server using a free SSL/TLS certificate from Let's Encrypt. This ensures secure communication between your server and clients.